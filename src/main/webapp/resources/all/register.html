<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
	<title>注册新用户</title>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="stylesheet" type="text/css" href="css/other.css">
	
	<style>
		.tm_register_body{
			background:url('images/001.jpg');
			background-size:cover;
			-moz-background-size:cover;
			background-repeat:no-repeat;
		}
		.tm_register_container{ width:500px; margin:100px auto; clear:both}
		.tm_register_title{
			height:80px;
			margin:10px 0 15px 0;
			background:#fff;
			text-align:center;
			border-bottom:solid 1px #eee;
		}
		.tm_register_title img{
			height:50px;
		}
		.tm_register_title span{
			font-size:25px; 
			line-height:80px;
			font-family:'Microsoft Yahei',Tahoma, Geneva, 'Simsun';
		}
		.tm_register_form{ 
			width:100%; 
			height:630px;
			clear:both; 
			-moz-border-radius:8px;
			-webkit-border-radius:8px;
			border-radius:8px;
			padding:1px;
			background:#fff;
		}
		.tm_register_table{ width:400px; margin:20px auto;}
		.tm_register_table caption{text-align:center; margin:0 0 10px 0}
		.tm_register_table tr th{ width:100px;}
		.tm_register_table tr td{ width:300px; text-align:left}

		.tm_register_title_table{ width:400px; margin:0px auto;}
		.tm_register_title_table tr th{ width:100px;}
		.tm_register_title_table tr td{ width:300px; text-align:left}
		
		.tm_register_foot{ width:100%; line-height:20px; text-align:center; clear:both; margin:20px 0}
		
	</style>
	
  </head>
  
<body class="tm_register_body" style="">

	<div class="tm_register_container">
    	<div class="tm_register_form">
			<div class="tm_register_title">
				<table border="0" cellpadding="0" cellspacing="0" class="tm_register_title_table">
					<tbody><tr>
						<th><img src="images/logo_min.png" align="absmiddle"></th>
						<td>
							<span>注册新用户</span>
						</td>
					</tr>
				</tbody></table>
			</div>
			
			<form action="http://demo.tomexam.com/" id="form_register" method="post">
            <table border="0" cellpadding="5" cellspacing="0" class="tm_register_table">
				<caption>
					
						
							<p>填写以下表单信息，注册成为新用户</p>
						
						
					
				</caption>
                <tbody><tr>
                    <th>用户名</th>
                    <td>
						<input type="text" class="validate[required,custom[onlyLetterNumberLine],minSize[6]] tm_txt" name="u_username" maxlength="30" value="" style="width:200px">
						<span class="tm_required">*</span> 
					</td>
                </tr>
                <tr>
                    <th><div style="margin-bottom:45px">密 &nbsp; 码</div></th>
                    <td>
						<input type="password" class="validate[required] tm_txt" name="u_userpass" id="u_userpass" maxlength="30" value="" style="width:200px">
						<span class="tm_required">*</span>
						
						<div id="tm_level" class="pw-strength">
							<div class="pw-bar"></div>
							<div class="pw-bar-on"></div>
							<div class="pw-txt">
								<span>弱</span>
								<span>中</span>
								<span>强</span>
							</div>
						</div>

					</td>
                </tr>
                <tr>
                    <th>确认密码</th>
                    <td>
						<input type="password" class="validate[required,equals[u_userpass]] tm_txt" name="u_userpass2" maxlength="30" value="" style="width:200px">
						<span class="tm_required">*</span>
					</td>
                </tr>
				<tr>
                    <th>真实姓名</th>
                    <td>
						<input type="text" name="u_realname" class="tm_txt" size="50" maxlength="30" style="width:200px">
					</td>
                </tr>
				<tr>
					<th>所属部门</th>
					<td>
						<select class="validate[required] tm_select" name="u_branchid" style="width:214px">
							<option value="">请选择</option>
							
							<option value="00db177e-36be-4011-8a07-c5cada0f9145">2024党课</option>
							
							<option value="5042f230-b760-4205-9306-1bc03a35da35">2026党课</option>
							
							<option value="64b3efb0-7ce8-4a92-abd5-d1c7ac23506b">2019党课</option>
							
							<option value="24e34d3c-09dc-427f-8f2c-04c6570fb322">2023党课</option>
							
							<option value="911e3a86-fa0d-4469-bdff-e80996c92f8a">2027党课</option>
							
							<option value="1096e868-79c2-477e-bbec-8b25d5134a79">2020党课</option>
							
							<option value="9c5c0801-44ba-43ec-8d26-e4c52c0264c7">2022党课</option>
							
							<option value="b38a1fd8-1205-4246-b9b7-26d1b9661dce">2028党课</option>
							
							<option value="e50ea44e-ba9c-4a83-a200-379975d70cf3">2025党课</option>
							
							<option value="43435e9c-ccb6-43b9-9c0f-6df0ed72d32e">2021党课</option>
							
							<option value="a4042326-78ec-4371-b311-7e64ff3010b5">兰州石化职业技术学院</option>
							
							<option value="00fd6225-5608-4809-8efe-64847380705b">交通局</option>
							
							<option value="e65e080e-a59d-4165-a0cd-a25ef814bd59">党课小组测试</option>
							
							<option value="43389094-2fa8-4986-8bfd-6eadcf94f1e3">造价</option>
							
							<option value="100869f4-0876-4996-882d-3c98692191e7">部门A</option>
							
							<option value="8714c924-8a09-481b-b5a6-496e74d057d1">部门C</option>
							
							<option value="38a3128c-d893-4531-946e-9527520bd452">部门B</option>
							
							<option value="3466d9cf-1b25-4252-b90f-d595d91aaea5">杜鹃一班</option>
							
							<option value="4f64aaea-f98b-418f-b8e9-a937e5732f39">XX大学二班</option>
							
							<option value="c41a3037-0231-4e75-9adc-7c928c670977">XX大学一班</option>
							
							<option value="83658be4-c2bd-480f-9854-bdd0df85fd1c">21</option>
							
							<option value="3eb4e1c9-a278-41d3-9ef3-855ce291137f">HW-研发部</option>
							
							<option value="05db22b6-e45d-4e15-b07d-d4a437281e13">行政部</option>
							
							<option value="96a09f84-9c4e-47b0-a273-d8da91bc6fc2">机构3333</option>
							
							<option value="0e60401d-5473-4c8d-b497-e6f64f76d235">xj</option>
							
							<option value="6b98e44e-e8bf-4607-bea9-a67e10c86503">1</option>
							
							<option value="078f881e-d070-42ff-84ea-5d72031965fd">ceshibumen16</option>
							
							<option value="19946ef3-4577-4968-8c40-cdb25c083967">2018-2019-1数码1</option>
							
							<option value="55b99f11-7d82-44bb-9815-1e14db03ef6f">机构1</option>
							
							<option value="384ecf9b-c07a-4ba5-bd72-2ce9fa243a86">dasf</option>
							
							<option value="827ea7bb-138d-425e-9fdf-13e97172b039">测试部门</option>
							
						</select>
						<span class="tm_required">*</span>
					</td>
				</tr>
				
				<tr>
                    <th>证件编号</th>
                    <td><input type="text" class="tm_txt" name="u_no" maxlength="30" value="" style="width:200px"></td>
                </tr>
				
                <tr>
                    <th></th>
                    <td>
						<div style="margin-top:40px">
							
								
									<button type="button" class="tm_btn tm_btn_primary" style="width:50%" onclick="tm.doRegister();">提交</button>
								
								
							
							
							<button type="button" class="tm_btn" onclick="tm.doGoBack();" style="width:30%">返回</button>
						</div>
                    </td>
                </tr>
                <tr>
                    <th></th>
                    <td></td>
                </tr>
            </tbody></table>
			</form>
        </div>
		
		<div class="tm_register_foot">
			
			<div>Copyright © 【猿来入此】  All Right Reserved 2015-2019</div>
		</div>
	</div>

	
	
	<script src="js/jquery.js" type="text/javascript"></script>
	<script src="js/baseutil.js" type="text/javascript"></script>
	<script src="js/aes.js" type="text/javascript"></script>
	<script src="js/pad-zeropadding-min.js" type="text/javascript"></script>

	<link rel="stylesheet" href="css/validationEngine.jquery.css">
	<script src="js/jquery.validationEngine.js"></script>
	
	
	<script src="js/jquery.validationEngine-zh_CN.js"></script>
	

	

	<script type="text/javascript">
		$(document).ready(function(){ 
			tm_bindPasswordLevelChecker("u_userpass");
		}); 

		var tm = {
			doGoBack : function(){
				window.location.href = 'login.html';
			},

			reloadImgcode : function(){
				$("#img_verifycode").attr("src", "http://demo.tomexam.com/inc/checkcode.jsp?t=" + Math.random());
			},

			doencrypt : function(data){
				
				
					
					var key = CryptoJS.enc.Latin1.parse('0dkw650vfk5l4crb');
					var iv = CryptoJS.enc.Latin1.parse('448bxu2qkuq3tdgg');
					return CryptoJS.AES.encrypt(data, key, {iv:iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding}).toString();
					
					
				
			},

			doRegister : function(){

				var formcheck = $("#form_register").validationEngine('validate', {showOneMessage: true});

				if(!formcheck){
					return false;
				}

				var u_username = $("input[name='u_username']").val();
				var u_userpass = $("input[name='u_userpass']").val();
				var u_realname = $("input[name='u_realname']").val();
				
				var u_branchid = $("select[name='u_branchid']").val();
				var u_no = $("input[name='u_no']").val();
				var u_usercode = $("input[name='u_usercode']").val();
				var u_positionid = $("select[name='u_positionid']").val();

				if(baseutil.isEmpty(u_username)){
					alert('没有填写用户名');
					return;
				}
				if(baseutil.isEmpty(u_userpass)){
					alert('没有填写登录密码');
					return;
				}
				if(baseutil.isEmpty(u_usercode)){
					alert('没有填写验证码');
					return;
				}

				if(baseutil.containsSpecialWord(u_username)){
					alert("用户名中不能包含特殊字符");
					return;
				}

				$(".tm_btn_primary").text('提交...');
				var tmdata = {
						"u_username":u_username, "u_userpass":tm.doencrypt(u_userpass), 
						"u_branchid":u_branchid, "u_no":u_no, 
						"u_usercode":u_usercode, "u_positionid":u_positionid,
						"u_realname":u_realname, "t":Math.random()};
				
				$.ajax({
					type: "POST",
					url: "http://demo.tomexam.com/common/register.do",
					dataType: "json",
					data: tmdata,
					success: function(data){
						if(data){
							var ret_code = data["code"];
							var ret_msg = data["message"];

							if(ret_code == 1 || ret_code == "1"){
								alert(ret_msg);
								window.location="login.html";
							}else{
								alert(ret_msg);
								//$(".tm_btn_primary").text('提交');
								//return;
								window.location.reload();
							}
						}
					},
					error: function(){
						//$(".tm_btn_primary").text('登录');
						alert('系统忙，请稍后再试');
						window.location.reload();
					}
				}); 
			}
		};
	</script>



</body></html>